# DIS 2



## 1 True and False

**(a) 查询16字节记录时，确切地从磁盘读取16字节数据。**

错

 **(b) 向SSD驱动器写入的成本高于从SSD驱动器读取。**

对

 **(c) 在堆文件中，所有页面必须被填充到最大容量，除了最后一页。**

错

 **(d) 假设整数占用4字节，指针占用4字节，一个大小为512字节的槽目录可以在一页中寻址64条记录。**

错

 **(e) 在一个包含固定长度记录且没有可空字段的页面中，位图的大小永远不会改变。**

对



**关于使用记录头来处理可变长度记录的好处，以下哪些是正确的？**

 **(a) 不需要使用分隔符字符来分隔记录中的字段**

对

 **(b) 与固定长度记录格式相比，空间成本始终匹配或优于**

错

 **(c) 可以在不扫描整个记录的情况下访问任何字段**

对

 **(d) 对空值具有紧凑的表示**

对



## 2 Fragmentation And Record Formats

**(a) 在打包固定长度记录页面格式中，碎片化是一个问题吗？**

不是

 **(b) 在具有槽页面的可变长度记录中，碎片化是一个问题吗？**

是

**(c) 我们通常在具有固定长度记录的页面中使用位图。为什么不直接在具有固定长度记录的页面中使用槽页面？**

对于固定长度记录，可以通过简单的算术运算得到记录在页面中的位置，无需使用槽页面。



## 3 Record Formats

**假设我们有一个如下所示的表：**

```sql
CREATE TABLE Questions (
    qid integer PRIMARY KEY,
    answer integer,
    qtext text,
);
```

**回想一下，整数和指针都是4字节长。假设在此问题中，记录头存储指向所有可变长度字段的指针（记录头中只有这些指针）。**

**(a) 最小可能的记录需要多少字节？**

12

**(b) 现在假设每个字段都是可空的，因此我们在记录头的开始部分添加一个位图，指示每个字段是否为空。假设该位图进行了填充，使其占用整字节数（例如，如果位图是10位，它将占用2个完整字节）。假设`qtext`字段为空，最大的可能记录有多大？**

21

<font color='red'>13</font>

## 4 Calculate the IOs with Linked List Implementation

**假设我们有一个通过链表实现的堆文件 A，且堆文件 A 有 5 个已满的页面和 2 个有空闲空间的页面，其中至少一个页面有足够的空间来插入一个记录。**

**(a) 在最坏的情况下，需要多少次 I/O 操作才能找到一个具有足够空闲空间的页面来插入记录？**

3

**(b) 在最坏的情况下，写入记录到第二个有空闲空间的页面需要多少次 I/O 操作？考虑写入后，页面变满，并假设头页面可以在已满页面链表的开始处插入记录。**

8



## 5 Calculate the IOs with Page Directory Implementation

**假设我们有一个通过页面目录实现的堆文件 B。目录中的一个页面可以容纳 16 个页面条目。文件 A 中共有 54 个页面。**

**(a) 在最坏的情况下，需要多少次 I/O 操作才能找到一个有空闲空间的页面？**

4

**(b) 在最坏的情况下，写入记录到一个有空闲空间的页面需要多少次 I/O 操作（假设至少有一个空闲页面有足够的空间来插入记录）？**

6

<font color='red'>7 = 4 + 1 + 1 + 1</font>